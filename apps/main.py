from typing import Any, Dict
# import libs.postgres as pg
import json
from typing import Any
from starlette.responses import JSONResponse
from datetime import datetime

# tg = pg.TestPG()
# tg.test_import()


str_prices = "[{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"58562.1\",\"qty\":\"0.2\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"},{\"price\":\"60000\",\"qty\":\"38.01917\"}]"

str_prices_json = json.loads(str_prices)
print(f"json first: {str_prices_json}")

prices = {}
final_ob = []
for item in str_prices_json:
    prices[f"{item['price']}:{item['qty']}"] = { 'price': item['price'], 'qty': item['qty'] }

for key in prices:
    final_ob.append(prices[key])

print(f"json seconds: {prices}")
print(f"json seconds: {final_ob}")

def test_return(b: bool):
    if b:
        return "market", "test"
    else:
        raise BaseException(500, "testing message")
try:
    test, test1 = test_return(False)
except BaseException as e:
    # obj = json.loads(e.args[0])
    code: int = e.args[0]
    msg: str = e.args[1]
    print(f"code: {code} msg: {msg}")

import time
print(time.time())

# print(f"test {test} test1 {test1}")

